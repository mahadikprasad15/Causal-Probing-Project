`torch_dtype` is deprecated! Use `dtype` instead!
Config :: Model: Qwen/Qwen2.5-0.5B-Instruct | Device: mps | Base Dir: /Users/prasadmahadik/causal_probing_project
>>> 1. Preparing Data for Causal Tracing...
Train Size: 213
Test ID Size: 54
Test OOD Size: 550
>>> 2. Loading Model...
Loading model: Qwen/Qwen2.5-0.5B-Instruct on mps
Loaded pretrained model Qwen/Qwen2.5-0.5B-Instruct into HookedTransformer
>>> 3. Running Causal Tracing (Head Ablation)...
Computing mean activations for ablation...
Baseline Pass:   0%|          | 0/25 [00:00<?, ?it/s]Baseline Pass:   4%|▍         | 1/25 [00:00<00:20,  1.17it/s]Baseline Pass:   8%|▊         | 2/25 [00:01<00:12,  1.89it/s]Baseline Pass:  12%|█▏        | 3/25 [00:01<00:07,  2.85it/s]Baseline Pass:  16%|█▌        | 4/25 [00:01<00:05,  3.80it/s]Baseline Pass:  20%|██        | 5/25 [00:01<00:05,  3.82it/s]Baseline Pass:  24%|██▍       | 6/25 [00:01<00:04,  4.56it/s]Baseline Pass:  32%|███▏      | 8/25 [00:01<00:02,  6.66it/s]Baseline Pass:  36%|███▌      | 9/25 [00:02<00:03,  5.06it/s]Baseline Pass:  44%|████▍     | 11/25 [00:02<00:02,  5.99it/s]Baseline Pass:  48%|████▊     | 12/25 [00:02<00:02,  6.19it/s]Baseline Pass:  56%|█████▌    | 14/25 [00:02<00:01,  7.82it/s]Baseline Pass:  64%|██████▍   | 16/25 [00:03<00:00,  9.10it/s]Baseline Pass:  72%|███████▏  | 18/25 [00:03<00:00, 10.20it/s]Baseline Pass:  80%|████████  | 20/25 [00:03<00:00, 10.96it/s]Baseline Pass:  88%|████████▊ | 22/25 [00:03<00:00,  9.93it/s]Baseline Pass:  96%|█████████▌| 24/25 [00:03<00:00, 10.62it/s]Baseline Pass: 100%|██████████| 25/25 [00:03<00:00,  6.59it/s]
Average Baseline Logit Diff: -0.5661
Running ablation on subset of 64 examples...
Layers:   0%|          | 0/24 [00:00<?, ?it/s]Layers:   4%|▍         | 1/24 [00:11<04:15, 11.10s/it]Layers:   8%|▊         | 2/24 [00:21<04:00, 10.94s/it]Layers:  12%|█▎        | 3/24 [00:32<03:48, 10.88s/it]Layers:  17%|█▋        | 4/24 [00:43<03:37, 10.86s/it]Layers:  21%|██        | 5/24 [00:54<03:26, 10.85s/it]Layers:  25%|██▌       | 6/24 [01:05<03:15, 10.86s/it]Layers:  29%|██▉       | 7/24 [01:16<03:04, 10.88s/it]Layers:  33%|███▎      | 8/24 [01:27<02:55, 10.96s/it]Layers:  38%|███▊      | 9/24 [01:38<02:44, 10.98s/it]Layers:  42%|████▏     | 10/24 [01:49<02:34, 11.02s/it]Layers:  46%|████▌     | 11/24 [02:00<02:23, 11.00s/it]Layers:  50%|█████     | 12/24 [02:11<02:11, 10.98s/it]Layers:  54%|█████▍    | 13/24 [02:22<02:02, 11.16s/it]Layers:  58%|█████▊    | 14/24 [02:34<01:51, 11.16s/it]Layers:  62%|██████▎   | 15/24 [02:45<01:40, 11.13s/it]Layers:  67%|██████▋   | 16/24 [02:56<01:30, 11.33s/it]Layers:  71%|███████   | 17/24 [03:08<01:19, 11.29s/it]Layers:  75%|███████▌  | 18/24 [03:19<01:07, 11.24s/it]Layers:  79%|███████▉  | 19/24 [03:30<00:56, 11.33s/it]Layers:  83%|████████▎ | 20/24 [03:42<00:45, 11.35s/it]Layers:  88%|████████▊ | 21/24 [03:53<00:34, 11.36s/it]Layers:  92%|█████████▏| 22/24 [04:05<00:22, 11.39s/it]Layers:  96%|█████████▌| 23/24 [04:16<00:11, 11.54s/it]Layers: 100%|██████████| 24/24 [04:28<00:00, 11.52s/it]Layers: 100%|██████████| 24/24 [04:28<00:00, 11.18s/it]
>>> 4. Saving Causal Scores...

Top 10 Causal Heads (Layer.Head):
L8.H1: 0.4691
L8.H4: 0.4144
L8.H9: 0.3880
L2.H8: 0.3875
L6.H7: 0.3846
L6.H13: 0.3646
L2.H11: 0.3509
L5.H6: 0.3299
L0.H0: 0.3275
L2.H3: 0.3270
